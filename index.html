<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>nat.ggplot • nat.ggplot</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="nat.ggplot">
<meta name="description" content="ggplot2-based visualisation for natverse neurons &amp; meshes">
<meta property="og:description" content="ggplot2-based visualisation for natverse neurons &amp; meshes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">nat.ggplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natverse/nat.ggplot"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/banner.png?raw=true" alt="Example circuit"><div class="figcaption">Example circuit</div>
</div>
<div class="section level1">
<div class="page-header"><h1 id="natggplot">nat.ggplot<a class="anchor" aria-label="anchor" href="#natggplot"></a>
</h1></div>
<p><code>nat.ggplot</code> enables the <a href="https://jefferis.github.io/nat/" class="external-link">Neuroanatomy Toolbox (nat)</a> suite to create publication-quality 2D visualisations of neurons and brain meshes using <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a>. This package bridges the gap between nat’s 3D neuroanatomy capabilities and ggplot2’s 2D plotting framework, allowing users to create figures of neuronal morphology data. This README uses sample data from the BANC connectome, but the package is valid for any neuroanatomical data from any organism, that can be represented as a neuron object, .swc, mesh3d, .surf, .obj file, etc.</p>
<p>See <a href="https://natverse.org/" class="external-link">nat</a> for details on reading neuroanatomy data into R.</p>
<div class="section level2">
<h2 id="about-neuron-objects">About Neuron Objects<a class="anchor" aria-label="anchor" href="#about-neuron-objects"></a>
</h2>
<p>In the <a href="https://natverse.org/" class="external-link">natverse ecosystem</a>, neurons are represented as tree structures containing 3D coordinates and connectivity information. The main data structures include:</p>
<ul>
<li>
<strong>neuron</strong>: A single neuron with XYZ coordinates and parent-child connectivity defining the tree structure, <code>neuron$d</code> provides data in the style of a .swc file, where <code>neuron$d$Label</code> can give the arbour type, e.g. dendrite versus axon.</li>
<li>
<strong>neuronlist</strong>: A collection of neurons that can be manipulated together, bundled as a list of class ‘neuronlist’</li>
<li>
<strong>mesh3d</strong>: 3D surface meshes representing brain regions or neuron surfaces</li>
<li>
<strong>Synaptic information</strong>: Pre- and postsynaptic site locations that can be overlaid on morphology</li>
</ul>
<p>For more details, see the <a href="https://natverse.org/nat/articles/neurons-intro.html" class="external-link">natverse neurons introduction</a></p>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/figure.png?raw=true" alt="figure"><div class="figcaption">figure</div>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of nat.ggplot from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'natverse/nat.ggplot'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/nat.ggplot" class="external-link">nat.ggplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set output directory for saving figures (change as needed)</span></span>
<span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="st">"inst/images/"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">output_dir</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">output_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise neurons with default settings</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span><span class="va">banc.meshes</span>, rotation_matrix <span class="op">=</span> <span class="va">banc_view</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"quickstart_basic.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/quickstart_basic.png?raw=true" alt="Basic visualisation"><div class="figcaption">Basic visualisation</div>
</div>
<p>Here is a more complicated plot, with a brain mesh, neuron meshes, their skeletons and their root points highlighted with a small black circle:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Smooth neurons for better presentation</span></span>
<span><span class="va">banc.skels_smoothed</span> <span class="op">&lt;-</span> <span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nlapply.html" class="external-link">nlapply</a></span><span class="op">(</span><span class="va">banc.skels</span>,<span class="fu">nat</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/nat/man/smooth_neuron.html" class="external-link">smooth_neuron</a></span>,sigma <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Customise visualisation with g.anat base</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.brain_neuropil</span>, </span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"grey60"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.meshes</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#6D2C7B"</span>, <span class="st">"#FF1493"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>              alpa <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              root <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"quickstart_custom.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/quickstart_custom.png?raw=true" alt="Customised visualisation"><div class="figcaption">Customised visualisation</div>
</div>
<div class="section level3">
<h3 id="finding-the-right-view">Finding the Right View<a class="anchor" aria-label="anchor" href="#finding-the-right-view"></a>
</h3>
<p>Compared with a simple <code>rgl</code> plot for neurons (e.g. <code>plot3d(banc.skels)</code>), the challenge with <code>nat.ggplot2</code> is that you need to transform your data, for the view you wish, so that the X-axis is the horziontal extent of your view and the Y-axis is the vertical.</p>
<p>To do this, you can call <code>plot3d(banc.skels)</code>, position neurons into the view you like, then use the helper function <code>rgl_view</code>, to extract the view as a matrix:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/nat" class="external-link">nat</a></span><span class="op">)</span>  <span class="co"># for plot3d</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl" class="external-link">rgl</a></span><span class="op">)</span>  <span class="co"># for 3D interaction</span></span>
<span></span>
<span><span class="co"># Step 1: Plot neurons in 3D and rotate to desired view</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">banc.brain_neuropil</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Rotate with mouse to find the desired angle</span></span>
<span><span class="co"># Step 3: Capture the view</span></span>
<span><span class="va">my_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rgl_view.html">rgl_view</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 4: Use the captured view in ggplot2</span></span>
<span><span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>, rotation_matrix <span class="op">=</span> <span class="va">my_view</span><span class="op">$</span><span class="va">userMatrix</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-gallery">Example Gallery<a class="anchor" aria-label="anchor" href="#example-gallery"></a>
</h2>
<div class="section level3">
<h3 id="setting-a-view-for-neuron-data">Setting a view for neuron data<a class="anchor" aria-label="anchor" href="#setting-a-view-for-neuron-data"></a>
</h3>
<p>Here are some view of the BANC brain neuropil mesh, extracted in that way:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the different view matrices from bancr</span></span>
<span><span class="va">views</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000764884985983372</span>, <span class="fl">0.0153511334210634</span>, </span>
<span>    <span class="op">-</span><span class="fl">0.99988180398941</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.940421104431152</span>, <span class="op">-</span><span class="fl">0.339961022138596</span>, </span>
<span>    <span class="op">-</span><span class="fl">0.00593886896967888</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.340011894702911</span>, <span class="fl">0.94031423330307</span>, </span>
<span>    <span class="fl">0.0141764245927334</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">401395.405539944</span>, <span class="op">-</span><span class="fl">128785.809090088</span>, </span>
<span>    <span class="op">-</span><span class="fl">5607.3408203126</span>, <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    front <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99931389093399</span>, <span class="fl">0.0139970388263464</span>, </span>
<span>      <span class="op">-</span><span class="fl">0.0342894680798054</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.0321401171386242</span>, <span class="op">-</span><span class="fl">0.132316529750824</span>, </span>
<span>      <span class="op">-</span><span class="fl">0.990686297416687</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.0184037387371063</span>, <span class="fl">0.991108655929565</span>, </span>
<span>      <span class="op">-</span><span class="fl">0.131775915622711</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      dorsal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.840221107006073</span>, <span class="fl">0.537661552429199</span>, </span>
<span>  <span class="op">-</span><span class="fl">0.0703445374965668</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.541468024253845</span>, <span class="fl">0.838866174221039</span>, </span>
<span>  <span class="op">-</span><span class="fl">0.0558210015296936</span>, <span class="fl">0</span>, <span class="fl">0.0289968233555555</span>, <span class="fl">0.0849913582205772</span>, </span>
<span>  <span class="fl">0.9959596991539</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ventral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.945645987987518</span>, <span class="op">-</span><span class="fl">0.325197845697403</span>, </span>
<span>  <span class="fl">3.18996608257294e-05</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.30071958899498</span>, <span class="op">-</span><span class="fl">0.874427616596222</span>, </span>
<span>  <span class="fl">0.380715191364288</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.123779848217964</span>, <span class="op">-</span><span class="fl">0.360031485557556</span>, </span>
<span>  <span class="op">-</span><span class="fl">0.924692392349243</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create plots for each view</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">view_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">views</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">view_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span></span>
<span>    <span class="va">banc.meshes</span>,</span>
<span>    volume <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># banc.brain_neuropil,</span></span>
<span>    rotation_matrix <span class="op">=</span> <span class="va">views</span><span class="op">[[</span><span class="va">view_name</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    cols1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#8B1A89"</span>, <span class="st">"#FF69B4"</span><span class="op">)</span>,</span>
<span>    cols2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey95"</span>, <span class="st">"grey85"</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">view_name</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">view_name</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">" view"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Display and save individual views</span></span>
<span><span class="va">plots</span><span class="op">$</span><span class="va">side</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"view_side.png"</span><span class="op">)</span>, <span class="va">plots</span><span class="op">$</span><span class="va">side</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">$</span><span class="va">front</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"view_front.png"</span><span class="op">)</span>, <span class="va">plots</span><span class="op">$</span><span class="va">front</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a collage using cowplot</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cowplot"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span>  <span class="co"># Combine plots in a 2x2 grid</span></span>
<span>  <span class="va">collage</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span></span>
<span>    <span class="va">plots</span><span class="op">$</span><span class="va">front</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="va">plots</span><span class="op">$</span><span class="va">side</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="va">plots</span><span class="op">$</span><span class="va">dorsal</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    <span class="va">plots</span><span class="op">$</span><span class="va">ventral</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>    label_size <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">collage</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"views_collage.png"</span><span class="op">)</span>, <span class="va">collage</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/views_collage.png?raw=true" alt="Multiple views collage"><div class="figcaption">Multiple views collage</div>
</div>
</div>
<div class="section level3">
<h3 id="visualising-brain-neuropil">Visualising Brain Neuropil<a class="anchor" aria-label="anchor" href="#visualising-brain-neuropil"></a>
</h3>
<p>You can visualise the brain neuropil mesh with different colours and transparency:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Brain neuropil with custom colours</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span><span class="va">banc.brain_neuropil</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"#EFC7E6"</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"brain_neuropil.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/brain_neuropil.png?raw=true" alt="Brain neuropil"><div class="figcaption">Brain neuropil</div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-neurons-with-custom-colours">Plotting Neurons with Custom Colours<a class="anchor" aria-label="anchor" href="#plotting-neurons-with-custom-colours"></a>
</h3>
<p>Visualise multiple neurons with different colouring schemes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All neurons in one colour</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"neurons_single_colour.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/neurons_single_colour.png?raw=true" alt="Single colour"><div class="figcaption">Single colour</div>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Colour gradient in the Z dimension:</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.meshes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"neurons_gradient.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/neurons_gradient.png?raw=true" alt="Gradient colouring"><div class="figcaption">Gradient colouring</div>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Each neuron in a different colour</span></span>
<span><span class="va">neuron_colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF6B6B"</span>, <span class="st">"#4ECDC4"</span>, <span class="st">"#45B7D1"</span>, <span class="st">"#FFA07A"</span>, <span class="st">"#98D8C8"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.brain_neuropil</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey95"</span>, <span class="st">"grey80"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="va">neuron_colours</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"neurons_multi_colour.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/neurons_multi_colour.png?raw=true" alt="Multiple colours"><div class="figcaption">Multiple colours</div>
</div>
</div>
<div class="section level3">
<h3 id="visualising-synapses">Visualising Synapses<a class="anchor" aria-label="anchor" href="#visualising-synapses"></a>
</h3>
<p>Display synaptic sites as coloured points:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create synapse visualisation</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span></span>
<span>  <span class="co"># Neuron meshes</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.meshes</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey60"</span>, <span class="st">"grey40"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Synapses as points</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.syns</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Just output synapses</span></span>
<span>                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">prepost</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>             rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>             root <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Point size for synapses</span></span>
<span>             cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EE4244"</span>, <span class="st">"#8B0000"</span><span class="op">)</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.syns</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Just input synapses</span></span>
<span>                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">prepost</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>             rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>             root <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Point size for synapses</span></span>
<span>             cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1BB6AF"</span>, <span class="st">"#121B56"</span><span class="op">)</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"synapses_visualisation.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/synapses_visualisation.png?raw=true" alt="Synapse visualisation"><div class="figcaption">Synapse visualisation</div>
</div>
</div>
<div class="section level3">
<h3 id="axon-dendrite-split-visualisation">Axon-Dendrite Split Visualisation<a class="anchor" aria-label="anchor" href="#axon-dendrite-split-visualisation"></a>
</h3>
<p>Visualise neurons with compartments coloured by their functional identity (using flow centrality from Schneider-Mizell et al., 2016). Note that this algorithm in implemented in the R package <code>hemibrainr</code>, <a href="https://natverse.org/hemibrainr/reference/flow_centrality.html" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single neuron with axon/dendrite split</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span><span class="va">banc.neurons.flow</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>              threshold <span class="op">=</span> <span class="fl">20000</span>, <span class="co"># Max distance over which a line is drawn between matching arbour</span></span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"neuron: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">banc.neurons.flow</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"split_single_neuron.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">6</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/split_single_neuron.png?raw=true" alt="Single split neuron"><div class="figcaption">Single split neuron</div>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All split neurons with brain context</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ggneuron.html">ggneuron</a></span><span class="op">(</span><span class="va">banc.neurons.flow</span>,</span>
<span>              <span class="co">#volume = banc.brain_neuropil,</span></span>
<span>              threshold <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              info <span class="op">=</span> <span class="st">"LHPD2a1 neurons:\n axon (orange), dendrite (cyan), primary neurite (purple), linker (green)\n inputs (navy), outputs (red)"</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"split_all_neurons.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/split_all_neurons.png?raw=true" alt="All split neurons"><div class="figcaption">All split neurons</div>
</div>
</div>
<div class="section level3">
<h3 id="creating-figures">Creating Figures<a class="anchor" aria-label="anchor" href="#creating-figures"></a>
</h3>
<p>Combine multiple elements for a figure:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comprehensive visualisation with zoom</span></span>
<span><span class="co"># Calculate bounding box of meshes after rotation</span></span>
<span><span class="va">mesh_bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">banc.meshes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mesh</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">$</span><span class="va">vb</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">banc_view</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">banc_view</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">vertices</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">vertices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, Y <span class="op">=</span> <span class="va">vertices</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add some padding (10% on each side)</span></span>
<span><span class="va">x_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">mesh_bounds</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">y_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">mesh_bounds</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">x_padding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">x_range</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span></span>
<span><span class="va">y_padding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">y_range</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span></span>
<span>  <span class="co"># Add brain outline</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.brain_neuropil</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey95"</span>, <span class="st">"grey85"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add neuron meshes</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.meshes</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey60"</span>, <span class="st">"grey40"</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add split neurons</span></span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.neurons.flow</span>,</span>
<span>              threshold <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>              root <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Zoom to neuron mesh bounds</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x_padding</span>, <span class="va">x_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">x_padding</span><span class="op">)</span>,</span>
<span>              ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">y_padding</span>, <span class="va">y_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">y_padding</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"LHPD2a1"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"lateral horn output neurons from the BANC connectome"</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span></span>
<span><span class="co"># Save figure</span></span>
<span><span class="co"># ggsave("lhpd2a1_neurons.pdf", p, width = 12, height = 12, dpi = 300)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"figure_comprehensive.png"</span><span class="op">)</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/figure_comprehensive.png?raw=true" alt="Comprehensive figure"><div class="figcaption">Comprehensive figure</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="data-attribution">Data Attribution<a class="anchor" aria-label="anchor" href="#data-attribution"></a>
</h2>
<p>This package includes example data from the BANC (Brain And Nerve Cord) connectome:</p>
<ul>
<li>
<strong>LHPD2a1 neurons</strong>: First characterized by Dolan et al. (2018) in <em>Neuron</em>
</li>
<li>
<strong>BANC connectome data</strong>: From Bates et al. (2025) in <em>bioRxiv</em>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h2>
<div class="section level3">
<h3 id="integration-with-ggplot2-ecosystem">Integration with ggplot2 Ecosystem<a class="anchor" aria-label="anchor" href="#integration-with-ggplot2-ecosystem"></a>
</h3>
<p>The package works with ggplot2 extensions:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>  <span class="co"># For combining plots</span></span>
<span></span>
<span><span class="co"># Create multiple panels - save individually</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, rotation_matrix <span class="op">=</span> <span class="va">banc_view</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Neuron 1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panel_neuron1.png"</span><span class="op">)</span>, <span class="va">p1</span>, width <span class="op">=</span> <span class="fl">4</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, rotation_matrix <span class="op">=</span> <span class="va">banc_view</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Neuron 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panel_neuron2.png"</span><span class="op">)</span>, <span class="va">p2</span>, width <span class="op">=</span> <span class="fl">4</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative 1: Use cowplot for combining plots</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cowplot"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Remove the theme elements that might conflict</span></span>
<span>  <span class="va">p1_clean</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Neuron 1"</span><span class="op">)</span></span>
<span>  <span class="va">p2_clean</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Neuron 2"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Combine with cowplot</span></span>
<span>  <span class="va">p_combined</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1_clean</span>, <span class="va">p2_clean</span>, ncol <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">p_combined</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panels_combined_cowplot.png"</span><span class="op">)</span>, <span class="va">p_combined</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Alternative 2: Use gridExtra for combining plots</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gridExtra"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Convert plots to grobs</span></span>
<span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Arrange in grid</span></span>
<span>  <span class="va">p_combined</span> <span class="op">&lt;-</span> <span class="fu">grid.arrange</span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panels_combined_gridextra.png"</span><span class="op">)</span>, <span class="va">p_combined</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Alternative 3: Use base R graphics with png files</span></span>
<span><span class="co"># Save individual plots first (already done above)</span></span>
<span><span class="co"># Then combine the PNG files using magick or other image processing</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"magick"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Read the individual plot images</span></span>
<span>  <span class="va">img1</span> <span class="op">&lt;-</span> <span class="fu">image_read</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panel_neuron1.png"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">img2</span> <span class="op">&lt;-</span> <span class="fu">image_read</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panel_neuron2.png"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Combine side by side</span></span>
<span>  <span class="va">img_combined</span> <span class="op">&lt;-</span> <span class="fu">image_append</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">img1</span>, <span class="va">img2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save combined image</span></span>
<span>  <span class="fu">image_write</span><span class="op">(</span><span class="va">img_combined</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"panels_combined_cowplot.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/panels_combined.png?raw=true" alt="Combined panels"><div class="figcaption">Combined panels</div>
</div>
</div>
<div class="section level3">
<h3 id="controlling-line-width">Controlling Line Width<a class="anchor" aria-label="anchor" href="#controlling-line-width"></a>
</h3>
<p>The <code>size</code> parameter controls the thickness of neuron skeleton lines:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plots with different line widths</span></span>
<span><span class="va">p_thin</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>, </span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.2</span>,  <span class="co"># Thin lines</span></span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF1493"</span>, <span class="st">"#8B008B"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Thin lines (size = 0.2)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"size_thin.png"</span><span class="op">)</span>, <span class="va">p_thin</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_normal</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>, </span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Default</span></span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF1493"</span>, <span class="st">"#8B008B"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Normal lines (size = 0.5)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"size_normal.png"</span><span class="op">)</span>, <span class="va">p_normal</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_thick</span> <span class="op">&lt;-</span> <span class="va">g.anat</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="reference/geom_neuron.html">geom_neuron</a></span><span class="op">(</span><span class="va">banc.skels_smoothed</span>, </span>
<span>              rotation_matrix <span class="op">=</span> <span class="va">banc_view</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">1</span>,  <span class="co"># Thick lines</span></span>
<span>              cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF1493"</span>, <span class="st">"#8B008B"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Thick lines (size = 1)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"size_thick.png"</span><span class="op">)</span>, <span class="va">p_thick</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine using cowplot</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cowplot"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span>  <span class="va">size_comparison</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span></span>
<span>    <span class="va">p_thin</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">p_normal</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">p_thick</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>    label_size <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="va">size_comparison</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"size_comparison.png"</span><span class="op">)</span>, <span class="va">size_comparison</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">300</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="https://github.com/natverse/nat.ggplot/blob/main/inst/images/size_comparison.png?raw=true" alt="Line width comparison"><div class="figcaption">Line width comparison</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This package was developed by Alexander Shakeel Bates while in the laboratory of Rachel I. Wilson at Harvard Medical School. The package leverages the <a href="https://natverse.github.io" class="external-link">natverse</a> ecosystem for neuroanatomy in R.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Key papers referenced in this package:</p>
<ul>
<li><p>Bates, A. S., Phelps, J. S., Kim, M., Yang, H. H., Matsliah, A., Ajabi, Z., Perlman, E., et al. (2025). Distributed control circuits across a brain-and-cord connectome. <em>bioRxiv</em>. doi: <a href="https://doi.org/10.1101/2025.07.31.667571" class="external-link">10.1101/2025.07.31.667571</a></p></li>
<li><p>Bates, Alexander Shakeel, James D. Manton, Sridhar R. Jagannathan, Marta Costa, Philipp Schlegel, Torsten Rohlfing, and Gregory Sxe Jefferis. 2020. “The Natverse, a Versatile Toolbox for Combining and Analysing Neuroanatomical Data.” eLife 9 (April). <a href="https://doi.org/10.7554/eLife.53350" class="external-link">eLife.53350</a></p></li>
<li><p>Dolan, M. J., et al. (2018). Communication from learned to innate olfactory processing centers is required for memory retrieval in Drosophila. <em>Neuron</em>, 100(3), 651-668. doi: <a href="https://doi.org/10.1016/j.neuron.2018.08.037" class="external-link">10.1016/j.neuron.2018.08.037</a></p></li>
<li><p>Jefferis, G. S. X. E., et al. (2007). Comprehensive maps of Drosophila higher olfactory centers. <em>Cell</em>, 128(6), 1187-1203. doi: <a href="https://doi.org/10.1016/j.cell.2007.01.040" class="external-link">10.1016/j.cell.2007.01.040</a></p></li>
<li><p>Schneider-Mizell, C. M., et al. (2016). Quantitative neuroanatomy for connectomics in Drosophila. <em>eLife</em>, 5, e12059. doi: <a href="https://doi.org/10.7554/eLife.12059" class="external-link">10.7554/eLife.12059</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>For issues and feature requests, please use the <a href="https://github.com/natverse/nat.ggplot/issues" class="external-link">GitHub issue tracker</a>
</li>
<li>For general natverse questions, visit the <a href="https://natverse.github.io" class="external-link">natverse documentation</a>
</li>
<li>For BANC connectome data, see the <a href="https://github.com/natverse/bancr" class="external-link">bancr package</a>
</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/natverse/nat.ggplot/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/natverse/nat.ggplot/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing nat.ggplot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://orcid.org/0000-0002-1195-0445" class="external-link">Alexander Bates</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1195-0445" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://natverse.github.io" class="external-link"><img src="https://img.shields.io/badge/natverse-Part%20of%20the%20natverse-a241b6" alt="natverse"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://natverse.github.io/nat.ggplot/reference/"><img src="https://img.shields.io/badge/docs-100%25-brightgreen.svg" alt="Docs"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0002-1195-0445" class="external-link">Alexander Bates</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
